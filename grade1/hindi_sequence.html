<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Hindi Swar & Vyanjan Quiz</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          padding: 20px;
          background: #f2f2f2;
        }
        .container {
          max-width: 800px;
          background: white;
          padding: 20px;
          border-radius: 12px;
          box-shadow: 0 0 10px #ccc;
          margin: auto;
        }
        select, button {
          font-size: 18px;
          padding: 8px 12px;
          margin: 10px 0;
        }
        .question {
          font-size: 32px;
          margin: 20px 0;
          text-align: center;
        }
        .options {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          margin-bottom: 10px;
        }
        .options button {
          margin: 5px;
          font-size: 22px;
          padding: 10px 16px;
          cursor: pointer;
        }
        .feedback {
          text-align: center;
          font-size: 22px;
          margin-top: 10px;
        }
        .next-btn {
          display: block;
          margin: 20px auto;
          font-size: 20px;
        }
        .score {
          font-size: 22px;
          text-align: center;
          margin-top: 10px;
        }
        .filled {
          padding: 0 10px;
          font-weight: bold;
        }
        .correct { color: green; }
        .wrong { color: red; }
        table {
          width: 100%;
          margin-top: 30px;
          border-collapse: collapse;
        }
        th, td {
          border: 1px solid #ccc;
          padding: 8px;
          text-align: center;
          font-size: 18px;
        }
        th { background: #eee; }
    </style>
</head>
<body>
<div class="container">
    <h2>Hindi Swar & Vyanjan Quiz</h2>
    <label>Select Mode:
        <select id="modeSelect">
            <option value="beforeafter">Before / After</option>
            <option value="sequence">Sequence Fill</option>
        </select>
    </label>
    <div class="question" id="question">Question will appear here</div>

    <div class="options" id="options1"></div>
    <div class="options" id="options2" style="display:none;"></div>

    <div class="feedback" id="feedback"></div>
    <button class="next-btn" onclick="generateQuestion()">Next</button>

    <div class="score" id="score">Score: 0</div>

    <table>
        <thead>
        <tr>
            <th>Question</th>
            <th>Your Answer</th>
            <th>Correct Answer</th>
            <th>Result</th>
        </tr>
        </thead>
        <tbody id="resultsTable"></tbody>
    </table>
</div>

<!-- Audio -->
<audio id="correctSound" src="https://www.soundjay.com/buttons/sounds/button-4.mp3" preload="auto"></audio>
<audio id="wrongSound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3" preload="auto"></audio>

<script>
    const swar = ["अ", "आ", "इ", "ई", "उ", "ऊ", "ऋ", "ए", "ऐ", "ओ", "औ", "अं", "अः"];
    const vyanjan = [
      "क", "ख", "ग", "घ", "ङ", "च", "छ", "ज", "झ", "ञ",
      "ट", "ठ", "ड", "ढ", "ण", "त", "थ", "द", "ध", "न",
      "प", "फ", "ब", "भ", "म", "य", "र", "ल", "व", "श", "ष", "स", "ह", "ळ"
    ];

    let score = 0;
    let currentQuestion = "";
    let correctAnswers = [];
    let filledAnswers = [];
    let currentLetterSet = [];

    const questionBox = document.getElementById("question");
    const optionsBox1 = document.getElementById("options1");
    const optionsBox2 = document.getElementById("options2");
    const feedbackBox = document.getElementById("feedback");
    const scoreBox = document.getElementById("score");
    const resultsTable = document.getElementById("resultsTable");
    const modeSelect = document.getElementById("modeSelect");
    const correctSound = document.getElementById("correctSound");
    const wrongSound = document.getElementById("wrongSound");

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function addResult(question, yourAns, correctAns, result) {
      const row = document.createElement("tr");
      row.innerHTML = `<td>${question}</td><td>${yourAns}</td><td>${correctAns}</td><td>${result ? "✔" : "✘"}</td>`;
      resultsTable.appendChild(row);
    }

    function generateQuestion() {
      feedbackBox.textContent = "";
      optionsBox1.innerHTML = "";
      optionsBox2.innerHTML = "";
      optionsBox2.style.display = "none";
      filledAnswers = [];
      const mode = modeSelect.value;
      currentLetterSet = Math.random() < 0.5 ? swar : vyanjan;

      if (mode === "beforeafter") {
        const idx = 1 + Math.floor(Math.random() * (currentLetterSet.length - 2));
        const direction = Math.random() < 0.5 ? "before" : "after";
        const target = currentLetterSet[idx];
        const answer = direction === "before" ? currentLetterSet[idx - 1] : currentLetterSet[idx + 1];
        correctAnswers = [answer];
        currentQuestion = direction === "before" ? `___ <span class="filled">${target}</span>` : `<span class="filled">${target}</span> ___`;
        questionBox.innerHTML = currentQuestion;

        const options = shuffle([answer, ...Array(9).fill().map(() => currentLetterSet[Math.floor(Math.random() * currentLetterSet.length)])]);
        options.forEach(opt => {
          const btn = document.createElement("button");
          btn.textContent = opt;
          btn.onclick = () => handleAnswer([opt]);
          optionsBox1.appendChild(btn);
        });

      } else {
        const seqLength = 3 + Math.floor(Math.random() * 2); // 3 or 4
        const start = Math.floor(Math.random() * (currentLetterSet.length - seqLength));
        const sequence = currentLetterSet.slice(start, start + seqLength);
        const missingCount = Math.random() < 0.5 ? 1 : 2;
        let blanks = shuffle([...Array(seqLength).keys()]).slice(0, missingCount).sort((a, b) => a - b);
        correctAnswers = blanks.map(i => sequence[i]);

        let display = sequence.map((ch, i) => blanks.includes(i) ? `<span id="blank${i}">___</span>` : `<span class="filled">${ch}</span>`).join("  ");
        questionBox.innerHTML = display;

        blanks.forEach((bIdx, setIdx) => {
          const optBox = setIdx === 0 ? optionsBox1 : optionsBox2;
          if (setIdx === 1) optionsBox2.style.display = "flex";
          const ans = correctAnswers[setIdx];
          const opts = shuffle([ans, ...Array(9).fill().map(() => currentLetterSet[Math.floor(Math.random() * currentLetterSet.length)])]);
          opts.forEach(opt => {
            const btn = document.createElement("button");
            btn.textContent = opt;
            btn.onclick = () => handleMultiAnswer(setIdx, opt, bIdx);
            optBox.appendChild(btn);
          });
        });
      }
    }

    function handleAnswer(selected) {
      const isCorrect = selected[0] === correctAnswers[0];
      const colorClass = isCorrect ? "correct" : "wrong";
      questionBox.innerHTML = questionBox.innerHTML.replace("___", `<span class="filled ${colorClass}">${selected[0]}</span>`);
      feedbackBox.textContent = isCorrect ? "✅ Correct!" : `❌ Wrong! Correct Answer: ${correctAnswers[0]}`;
      isCorrect ? correctSound.play() : wrongSound.play();
      if (isCorrect) score++;
      scoreBox.textContent = `Score: ${score}`;
      addResult(questionBox.innerText, selected[0], correctAnswers[0], isCorrect);
    }

    function handleMultiAnswer(index, selected, blankIndex) {
      const isCorrect = selected === correctAnswers[index];
      const colorClass = isCorrect ? "correct" : "wrong";
      document.getElementById(`blank${blankIndex}`).innerHTML = `<span class="filled ${colorClass}">${selected}</span>`;
      filledAnswers[index] = { val: selected, correct: isCorrect };

      if (filledAnswers.filter(Boolean).length === correctAnswers.length) {
        const allCorrect = filledAnswers.every(f => f.correct);
        feedbackBox.textContent = allCorrect ? "✅ Correct!" : `❌ Wrong! Correct: ${correctAnswers.join(", ")}`;
        if (allCorrect) score++;
        allCorrect ? correctSound.play() : wrongSound.play();
        scoreBox.textContent = `Score: ${score}`;
        addResult(questionBox.innerText, filledAnswers.map(f => f.val).join(", "), correctAnswers.join(", "), allCorrect);
      }
    }

    window.onload = generateQuestion;
</script>
</body>
</html>
